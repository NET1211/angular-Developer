name: Track origin update

on:
  schedule:
    - cron: "* * * * *"
env:
  ANGULAR_BRANCH: "11.2.x"
  GITHUB_TOKEN: ${{secrets.GITHUB_TOKEN}}

jobs:
  create-pr:
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v2
      with: 
        fetch-depth: 0
        submodules: true
    - run: echo "::set-output name=COMMIT_HASH::`gh api repos/angular/angular/git/ref/heads/${ANGULAR_BRANCH} --jq ".object.sha"`"
      working-directory: origin
      id: get-branch-head
    - uses: actions/setup-node@v2
      with:
        node-version: "14"
    - run: yarn install
    - run: yarn update-origin ${{steps.get-branch-head.outputs.COMMIT_HASH}}
    - run: git status
